<?xml version="1.0"?>
<profile xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns">

  <users config:type="list">
    <user>
      <username>root</username>
      <user_password>linux</user_password>
      <encrypted config:type="boolean">false</encrypted>
    </user>
  </users>

  <networking>
    <keep_install_network config:type="boolean">true</keep_install_network>
    <managed config:type="boolean">true</managed>
    <interfaces config:type="list">
      <interface>
        <name>eth0</name>
        <bootproto>dhcp</bootproto>
        <startmode>auto</startmode>
      </interface>
    </interfaces>
  </networking>

  <storage config:type="list">
    <drive>
      <device>/dev/vda</device>
      <initialize config:type="boolean">true</initialize>
      <partitions config:type="list">
        <partition>
          <mount>/</mount>
          <filesystem>ext4</filesystem>
          <size>4096</size>
        </partition>
      </partitions>
    </drive>
  </storage>

  <general>
    <mode>
      <halt config:type="boolean">false</halt>
      <confirm config:type="boolean">false</confirm>
      <second_stage config:type="boolean">false</second_stage>
    </mode>
    <self_update config:type="boolean">false</self_update>
    <signature-handling>
      <accept_file_without_checksum config:type="boolean">true</accept_file_without_checksum>
      <accept_non_trusted_gpg_key config:type="boolean">true</accept_non_trusted_gpg_key>
      <accept_unknown_gpg_key config:type="boolean">true</accept_unknown_gpg_key>
      <accept_unsigned_file config:type="boolean">true</accept_unsigned_file>
      <accept_verification_failed config:type="boolean">false</accept_verification_failed>
      <import_gpg_key config:type="boolean">true</import_gpg_key>
    </signature-handling>
  </general>

  <services-manager>
    <default_target>multi-user</default_target>
    <services>
        <disable config:type="list" />
        <enable config:type="list">
            <service>sshd</service>
        </enable>
    </services>
  </services-manager>

  <software>
    <packages config:type="list">
      <package>bash-completion</package>
      <package>btrfsprogs</package>
      <package>bzip2</package>
      <package>cloud-init</package>
      <package>glibc</package>
      <package>kernel-default</package>
      <package>openssh</package>
      <package>python3</package>
      <package>python3-configobj</package>
      <package>python3-PrettyTable</package>
      <package>python3-PyYAML</package>
      <package>sudo</package>
      <package>tar</package>
      <package>wget</package>
    </packages>
    <patterns config:type="list">
        <pattern>base</pattern>
    </patterns>
  </software>

  <scripts>
    <chroot-scripts config:type="list">
        <script>
            <filename>cloud-init.sh</filename>
	    <interpreter>shell</interpreter>
            <chrooted config:type="boolean">true</chrooted>
            <source><![CDATA[
#!/bin/sh
systemctl enable cloud-init-local.service
systemctl enable cloud-init.service
systemctl enable cloud-config.service
systemctl enable cloud-final.service
]]>
            </source>
        </script>
    </chroot-scripts>
    <init-scripts config:type="list">
       <script>
            <filename>clean-persistent-net.sh</filename>
            <source><![CDATA[
#!/bin/sh
cat< /dev/null > /etc/udev/rules.d/70-persistent-net.rules
sed -i s/^root:[^:]*/root:*/ /etc/shadow
rm -rf /root/.ssh
rm -rf /root/.cache
rm -rf /etc/ssh/ssh_host_*
]]>
            </source>
        </script>
    </init-scripts>
  </scripts>

</profile>
